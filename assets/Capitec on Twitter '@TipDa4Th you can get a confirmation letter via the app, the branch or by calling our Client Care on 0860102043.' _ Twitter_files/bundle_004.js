(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{"AEu/":function(e,t,a){"use strict";a.r(t),a.d(t,"ConversationHiddenRepliesScreen",(function(){return N}));var r=a("KEM+"),n=a.n(r),o=a("ERkP"),c=a("es0u"),s=(a("WNMA"),a("oEGd")),i=a("0KEI"),l=a("hqKg"),d=a("8Lfv"),u=a("G6rE");const g=Object(l.createSelector)((e,t)=>t.match.params.screenName,(e,t)=>t.match.params.statusId,(e,t)=>"PUSH"===t.history.action,u.e.selectLoggedInUser,(e,t,a,r)=>({loggedInScreenName:r?r.screen_name:void 0,screenName:e,statusId:t,isForwardNavigation:a})),m={createLocalApiErrorHandler:Object(i.d)("HIDDEN_REPLIES_PAGE"),clearTimelineCache:e=>Object(d.a)(e)};var h=Object(s.g)(g,m),p=a("7JQg"),b=a("xZXe"),_=a("QIgh"),y=a("8UdT"),E=a("IcAo"),f=a("VrCx"),A=a("yy6l");const O=e=>Object(A.a)({component:b.a,createAdditionalProps:()=>({withUnhideReply:e}),displayBlocked:!0,divider:{top:!0,bottom:!0}});var T=({withUnhideReply:e})=>Object(E.a)({},_.b,{[y.b.Tweet]:{handlers:{[f.a.Tweet]:O(e)}}}),w=a("WU0f"),I=a("yoO3"),P=a("fTQJ"),k=a("VS6U"),S=a("t62R"),L=a("FIs5"),C=a("I7xG"),v=a("3XMw"),j=a.n(v);const B=j.a.d806aa19,D=j.a.d80c77dc,q=j.a.ef939f4b,F=j.a.f7f2db4f,x=o.createElement(j.a.I18NFormatMessage,{$i18n:"cf1aca58"},o.createElement(S.c,{link:"https://help.twitter.com/using-twitter/mentions-and-replies#hidden-reply"},j.a.a7511618)),R=()=>o.createElement(L.a,{header:F,message:x});class N extends o.Component{constructor(e){super(e),n()(this,"_getModule",Object(C.a)(this,e=>e.statusId,e=>Object(w.a)(e))),this._clearTimelineCache()}render(){const{history:e,loggedInScreenName:t,screenName:a,statusId:r}=this.props;return a&&r?o.createElement(I.a,null,o.createElement(k.a,{backLocation:`/${a.toLowerCase()}/status/${r}`,history:e,primaryContent:this._renderPrimaryContent(),sidebarContent:o.createElement(c.a,null),subtitle:a===t?D:q({screenName:a}),title:B})):null}_renderPrimaryContent(){const{loggedInScreenName:e,screenName:t}=this.props;return o.createElement(P.a,{entryConfiguration:T({withUnhideReply:t===e}),module:this._getModule(),renderEmptyState:R,title:B})}_clearTimelineCache(e=this._getModule()){const{clearTimelineCache:t,createLocalApiErrorHandler:a,isForwardNavigation:r}=this.props;r&&t(e).catch(a({}))}}t.default=Object(p.c)({page:"tweet",section:"moderated_replies"})(h(N))},DL4F:function(e,t,a){"use strict";a.r(t),a.d(t,"ConversationAnalyticsScreen",(function(){return j}));a("IAdD"),a("WNMA"),a("kYxP");var r=a("KEM+"),n=a.n(r),o=a("ERkP"),c=a("v6aA"),s=(a("VAZu"),a("zh9S")),i=a("oEGd"),l=a("0KEI"),d=a("hqKg"),u=a("XOJV");const g=(e,t)=>t.match.params.statusId,m=Object(d.createSelector)((e,t)=>u.a.selectFetchStatus(e,g(0,t)),g,(e,t)=>u.a.selectHydrated(e,g(0,t)),(e,t,a)=>({fetchStatus:e,statusId:t,tweet:a})),h={createLocalApiErrorHandler:Object(l.d)("CONVERSATION_ANALYTICS_SCREEN"),fetchTweetIfNeeded:u.a.fetchOneIfNeeded,scribeAction:s.c};var p=Object(i.g)(m,h),b=a("7JQg"),_=a("v//M"),y=a("W5XZ"),E=a("jHSc"),f=a("3XMw"),A=a.n(f),O=a("SrIh"),T=a("Rp9C"),w=a("E0cF"),I=a("q9Zt"),P=a("bPFD"),k=a("rHpw"),S=a("yE5w");const L=A.a.g9079b93,C=A.a.a57daeb1,v=A.a.deaf5b15;class j extends o.PureComponent{constructor(...e){super(...e),n()(this,"_handleFetchTweet",()=>{const{createLocalApiErrorHandler:e,fetchTweetIfNeeded:t,statusId:a}=this.props;t(a).catch(e(y.a))}),n()(this,"_render",()=>{const{tweet:e}=this.props,t=e&&w.a.getOriginalTweet(e)||void 0;if(!t||t&&t.user.id_str!==this.context.loggedInUserId)return o.createElement(I.a,{onRetry:null,title:L});{const e="";return o.createElement(P.a,{dangerouslyDisableSandbox:!0,onMessage:this._handleIFrameMessage,reportError:O.a,src:`${e}/i/tfb/v1/quick_promote/lite/${t.id_str}`,style:B.iframe})}}),n()(this,"_setAppBarRef",e=>{this._appBarRef=e}),n()(this,"_handleGoBack",()=>{const{history:e,location:t}=this.props;e.goBackToNonModalRoute({location:t})}),n()(this,"_handleIFrameMessage",e=>{if(e&&"quick_promote"===e.name)if("scribe"===e.type){const{scribeAction:t,scribeNamespace:a,tweet:r}=this.props,n=r&&w.a.getOriginalTweet(r)||void 0,o=e.scribeData||{},c="string"==typeof o.component?o.component:"quick_promote",s="string"==typeof o.uiEvent?o.uiEvent:"";t(Object.assign({},a,{component:c,action:s}),Object.assign({},o,{items:n?[T.a.getTweetItem(n)]:[]}))}else if("navigation"===e.type){const{history:e,match:t,tweet:a}=this.props,r=a&&w.a.getOriginalTweet(a);r&&e.push(`/${t.params.screenName}/status/${r.id_str}/${S.a.Rweb}/${S.c.Intro}`)}else"close"===e.type&&this._appBarRef&&this._appBarRef.goBack()})}componentDidMount(){this._handleFetchTweet()}render(){const{fetchStatus:e,history:t,tweet:a}=this.props,r=a&&w.a.getOriginalTweet(a)||void 0;return o.createElement(E.b,{appBarRef:this._setAppBarRef,backLocation:r?r.permalink:"/",history:t,onBackClick:this._handleGoBack,title:C},o.createElement(_.a,{fetchStatus:e,render:this._render,retryMessage:v}))}}n()(j,"contextType",c.a);const B=k.a.create(e=>({iframe:{flexGrow:1}}));t.default=Object(b.c)({page:"tweet",section:"analytics"})(p(j))},JiIh:function(e,t,a){"use strict";var r=a("ERkP"),n=a("0GBF");t.a=e=>r.createElement(n.a,e)},aH1V:function(e,t,a){"use strict";a.r(t),a.d(t,"QuickPromoteScreen",(function(){return Gr}));a("JtPf"),a("x4t0"),a("WNMA"),a("kYxP");var r=a("KEM+"),n=a.n(r),o=a("ERkP");function c(e){throw new Error("Not reachable section reached!")}var s=a("E89d"),i=a("v6aA"),l=a("97Jx"),d=a.n(l),u=a("rxPX"),g=a("0KEI"),m=a("RqPI"),h=(a("IAdD"),a("LdEA")),p=a.n(h),b=a("oEOe"),_=a("kGix"),y=a("3A2y"),E=a("Ssj5");const f=Object.freeze({Any:"AnyGender",Male:"Male",Female:"Female"}),A=Object.freeze({AGE_13_TO_24:"Age13To24",AGE_13_TO_34:"Age13To34",AGE_13_TO_49:"Age13To49",AGE_13_TO_54:"Age13To54",AGE_18_TO_24:"Age18To24",AGE_18_TO_34:"Age18To34",AGE_18_TO_49:"Age18To49",AGE_18_TO_54:"Age18To54",AGE_21_TO_34:"Age21To34",AGE_21_TO_49:"Age21To49",AGE_21_TO_54:"Age21To54",AGE_25_TO_49:"Age25To49",AGE_25_TO_54:"Age25To54",AGE_35_TO_49:"Age35To49",AGE_35_TO_54:"Age35To54",AGE_OVER_13:"AgeOver13",AGE_OVER_18:"AgeOver18",AGE_OVER_21:"AgeOver21",AGE_OVER_25:"AgeOver25",AGE_OVER_35:"AgeOver35",AGE_OVER_50:"AgeOver50"}),O=Object.freeze({[A.AGE_13_TO_24]:{minAge:"13",maxAge:"24"},[A.AGE_13_TO_34]:{minAge:"13",maxAge:"34"},[A.AGE_13_TO_49]:{minAge:"13",maxAge:"49"},[A.AGE_13_TO_54]:{minAge:"13",maxAge:"54"},[A.AGE_18_TO_24]:{minAge:"18",maxAge:"24"},[A.AGE_18_TO_34]:{minAge:"18",maxAge:"34"},[A.AGE_18_TO_49]:{minAge:"18",maxAge:"49"},[A.AGE_18_TO_54]:{minAge:"18",maxAge:"54"},[A.AGE_21_TO_34]:{minAge:"21",maxAge:"34"},[A.AGE_21_TO_49]:{minAge:"21",maxAge:"49"},[A.AGE_21_TO_54]:{minAge:"21",maxAge:"54"},[A.AGE_25_TO_49]:{minAge:"25",maxAge:"49"},[A.AGE_25_TO_54]:{minAge:"25",maxAge:"54"},[A.AGE_35_TO_49]:{minAge:"35",maxAge:"49"},[A.AGE_35_TO_54]:{minAge:"35",maxAge:"54"},[A.AGE_OVER_13]:{minAge:"13"},[A.AGE_OVER_18]:{minAge:"18"},[A.AGE_OVER_21]:{minAge:"21"},[A.AGE_OVER_25]:{minAge:"25"},[A.AGE_OVER_35]:{minAge:"35"},[A.AGE_OVER_50]:{minAge:"50"}}),T=Object.freeze({13:{24:A.AGE_13_TO_24,34:A.AGE_13_TO_34,49:A.AGE_13_TO_49,54:A.AGE_13_TO_54,over:A.AGE_OVER_13},18:{24:A.AGE_18_TO_24,34:A.AGE_18_TO_34,49:A.AGE_18_TO_49,54:A.AGE_18_TO_54,over:A.AGE_OVER_18},21:{34:A.AGE_21_TO_34,49:A.AGE_21_TO_49,54:A.AGE_21_TO_54,over:A.AGE_OVER_21},25:{49:A.AGE_25_TO_49,54:A.AGE_25_TO_54,over:A.AGE_OVER_25},35:{49:A.AGE_35_TO_49,54:A.AGE_35_TO_54,over:A.AGE_OVER_35},50:{over:A.AGE_OVER_50}});a("jQ/y"),a("MvUL"),a("gYAx"),a("gFSH");var w=a("3XMw"),I=a.n(w),P=a("SrIh"),k=a("9OUN"),S=a("06wh");const L=Object.freeze({});function C(e,t){const a=Object(S.a)("rweb/ads/typeahead",e);return{typeaheadApiActionTypes:a,getTypeaheadResults:(r,n)=>(o,c,{api:s})=>{const i=c().ads.typeahead[e][r];if(null==i?void 0:i.result)return Promise.resolve(i.result);return Object(b.b)(o,{request:t(s),params:n})({actionTypes:a,context:"ADS_TYPEAHEAD_"+e,meta:{query:r}})},reducer:(e=L,t)=>{switch(t.type){case a.REQUEST:{const{query:a}=t.meta;return Object.assign({},e,{[a]:{fetchStatus:_.a.LOADING}})}case a.FAILURE:{const{error:a,meta:{query:r}}=t;return Object.assign({},e,{[r]:{fetchStatus:_.a.FAILED,error:a}})}case a.SUCCESS:{const{meta:{query:a},payload:r}=t;return Object.assign({},e,{[a]:{fetchStatus:_.a.LOADED,result:r}})}default:return e}}}}const v=C("targetingLocation",e=>e.Ads.getQueriedTargetableLocations),j=C("forecastAudience",e=>e.QuickPromote.getAudienceEstimate),B={targetingLocation:v.reducer,forecastAudience:j.reducer},D={typeahead:Object(k.c)(B)},q=Object(k.c)(D);E.a.register({ads:q});var F=a("yE5w");const x=I.a.c4384a5f,R=[_.a.LOADING,_.a.LOADED],N=(e,t)=>(a,r,{api:n})=>{var o,c;const{dailyBudget:s,currency:i}=r().quickPromote.budget,l=X(r()),{user_id:d}=r().session,u=null==(o=r().quickPromote.account.adsAccount)?void 0:o.id,{ageBucket:g,gender:m,targetedLocations:[{targeting_value:h}]}=r().quickPromote.targeting;if(R.includes(null==(c=r().ads.typeahead.forecastAudience[l])?void 0:c.fetchStatus)||!d||!g)return Promise.resolve();const p=Math.round(1e6*s),b=p,_=G(r());return Object(F.o)(t)(F.m.audienceEstimateCall({dailyBudgetMicros:p,totalBudgetMicros:b,ageBucket:g,gender:m,location:h})),a(j.getTypeaheadResults(l,{userId:d,adAccountId:""+parseInt(u,36),tweetId:e,dailyBudgetMicros:""+p,totalBudgetMicros:""+b,currency:null!=i?i:"USD",targeting:_})).then(()=>{var e,a;const n=null==(e=r().ads.typeahead.forecastAudience[l])||null==(a=e.result)?void 0:a.estimatedImpressions;n?Object(F.o)(t)(F.m.audienceEstimateSuccess({dailyBudgetMicros:p,totalBudgetMicros:b,ageBucket:g,gender:m,location:h,estimatedImpressions:n})):Object(F.o)(t)(F.m.audienceEstimateFail({dailyBudgetMicros:p,totalBudgetMicros:b,ageBucket:g,gender:m,location:h}))})};function G(e){const{targetedLocations:t,ageBucket:a,gender:r}=e.quickPromote.targeting;return{geos:t.map(({targeting_value:e})=>({location_id:e})),age_buckets:[{age_bucket:a}],gender:{gender:r}}}const M=e=>(t,a,{userPersistence:r})=>{const{quickPromote:n}=a(),{targeting:{targetedLocations:o,ageBucket:c,gender:s},budget:{dailyBudget:i,durationDays:l,currency:d}}=n;return r.set("rweb.quickPromoteRedirectBack",e?{platformType:e,ageBucket:c,gender:s,targetedLocations:o,dailyBudget:i,durationDays:l,lastPersisted:(new Date).getTime(),currency:d}:null)},U=(e,t)=>(a,r,{api:n})=>!t&&R.includes(r().quickPromote.account.accountDataFetchStatus)?Promise.resolve():(a(re(_.a.LOADING)),H(n)(e).then(e=>{if(e){const{account:t}=e;return a(ee(t)),V(n)(t.id).then(e=>{a(te(e)),a(ae(e[0]||null))})}}).then(()=>a(re(_.a.LOADED))).catch(e=>{throw a(re(_.a.FAILED)),e})),H=e=>t=>e.Ads.getAccounts().then(t=>Promise.all(t.map(t=>e.Ads.getPromoteableUsers(t.id).then(e=>({promoteableUsers:e,account:t})).catch(()=>{})))).then(e=>e.filter(Boolean)).then(e=>e.find(({promoteableUsers:e})=>e.find(e=>e.user_id===t))),V=e=>t=>e.Ads.getFundingInstruments(t).then(e=>e.filter(({able_to_fund:e,description:t})=>e&&!/no payment method/.test(t))),z=e=>(t,a)=>{t(ce(e));const r=Object(m.f)(a());return t(v.getTypeaheadResults(e,{query:e,lang:r}))},Q=()=>(e,t,{api:a,scribe:r})=>{if(R.includes(t().quickPromote.targeting.initialTargetedLocationsFetchStatus)||t().quickPromote.targeting.targetedLocations.length)return Promise.resolve();const n=Object(m.l)(t())||"US",o=t().session.language;return e(ne(_.a.LOADING)),a.Ads.getTargetableLocations({countryCode:n,lang:o,locationType:"COUNTRIES"}).then(e=>e.length?e:(Object(P.a)("Country not found: "+n),a.Ads.getTargetableLocations({countryCode:"US",lang:o,locationType:"COUNTRIES"}))).then(a=>{if(!a.length){const e=Error("Could not find targetable country for US!");throw Object(P.a)(e),e}if(t().quickPromote.targeting.targetedLocations.length)return Promise.resolve();e(oe(a)),e(ne(_.a.LOADED))}).catch(t=>{throw e(ne(_.a.FAILED)),t})},$=()=>(e,t,{api:a})=>{if(R.includes(t().quickPromote.budget.availableBudgetsFetchStatus))return Promise.resolve();e(le(_.a.LOADING));const r=K(t());return a.QuickPromote.getBudgets({countryCode:r}).then(({budgets:t,currencyCode:a})=>{e(de(t,a));const r=t[1];if(!r)throw new Error("No budget found");e(ue(r)),e(le(_.a.LOADED))}).catch(t=>{throw e(le(_.a.FAILED)),t})},W={account:{adsAccount:null,accountDataFetchStatus:_.a.NONE,fundingInstruments:[],selectedFundingInstrument:null},targeting:{initialTargetedLocationsFetchStatus:_.a.NONE,targetedLocations:[],locationQuery:"",ageBucket:A.AGE_OVER_18,gender:f.Any},budget:{errorMessage:null,dailyBudget:100,durationDays:5,availableBudgets:null,availableBudgetsFetchStatus:_.a.NONE,currency:null},firstLoad:!1,promoteStatus:_.a.NONE,promoteErrorCode:null},J=Object.freeze({REQUEST:"rweb/quickPromote/promoteRequest",SUCCESS:"rweb/quickPromote/promoteSuccess",FAILURE:"rweb/quickPromote/promoteFailure"}),K=e=>{var t,a;const r=(null==(t=e.quickPromote.account)||null==(a=t.adsAccount)?void 0:a.country_code)||Object(m.l)(e)||"US";return"XX"===r?"US":r.toUpperCase()},X=e=>{const t=e.quickPromote,{targeting:{targetedLocations:[{targeting_value:a}]},budget:{dailyBudget:r,durationDays:n,currency:o}}=t,c=p()(t.targeting,["targetedLocations"]),s=Object(y.a)(c,["initialTargetedLocationsFetchStatus","locationQuery"]);return JSON.stringify(Object.assign({},s,{location:a,dailyBudget:r,durationDays:n,currency:o}))},Z=e=>({type:"rweb/quickPromote/targeting/set",payload:{targeting:e}}),Y=e=>({type:"rweb/quickPromote/budget/set",payload:{budget:e}}),ee=e=>({type:"rweb/quickPromote/account/setAdsAccount",payload:{adsAccount:e}}),te=e=>({type:"rweb/quickPromote/account/setFundingInstruments",payload:{fundingInstruments:e}}),ae=e=>({type:"rweb/quickPromote/account/setSelectedFundingInstrument",payload:{selectedFundingInstrument:e}}),re=e=>({type:"rweb/quickPromote/account/setAccountDataFetchStatus",payload:{fetchStatus:e}}),ne=e=>({type:"rweb/quickPromote/targeting/setInitialTargetedLocationsFetchStatus",payload:{fetchStatus:e}}),oe=e=>({type:"rweb/quickPromote/targeting/setTargetedLocations",payload:{targetedLocations:e}}),ce=e=>({type:"rweb/quickPromote/targeting/setLocationQuery",payload:{locationQuery:e}}),se=e=>({type:"rweb/quickPromote/targeting/setTargetedAgeBucket",payload:{ageBucket:e}}),ie=e=>({type:"rweb/quickPromote/targeting/setTargetedGender",payload:{gender:e}}),le=e=>({type:"rweb/quickPromote/budget/setAvailableBudgetsFetchStatus",payload:{fetchStatus:e}}),de=(e,t)=>({type:"rweb/quickPromote/budget/setAvailableBudgets",payload:{availableBudgets:e,currency:t}}),ue=e=>({type:"rweb/quickPromote/budget/setDailyBudget",payload:{dailyBudget:e}}),ge=e=>({type:"rweb/quickPromote/budget/setBudgetDuration",payload:{durationDays:e}}),me=e=>({type:"rweb/quickPromote/budget/setBudgetErrorMessage",payload:{errorMessage:e}}),he=e=>({type:"rweb/quickPromote/setFirstLoad",payload:{firstLoad:e}}),pe=e=>({type:"rweb/quickPromote/setPromoteFetchStatus",payload:{promoteFetchStatus:e}}),be=e=>({type:"rweb/quickPromote/setPromoteErrorCode",payload:{promoteErrorCode:e}}),_e=e=>(t,a,{api:r})=>Object(b.b)(t,{request:r.QuickPromote.createPromotion,params:e})({actionTypes:J,context:"FETCH_PROMOTE"});E.a.register({quickPromote:(e=W,t)=>{switch(t.type){case"rweb/quickPromote/account/set":{const{account:a}=t.payload;return Object.assign({},e,{account:Object.assign({},e.account,a)})}case"rweb/quickPromote/targeting/set":{const{targeting:a}=t.payload;return Object.assign({},e,{targeting:Object.assign({},e.targeting,a)})}case"rweb/quickPromote/budget/set":{const{budget:a}=t.payload;return Object.assign({},e,{budget:Object.assign({},e.budget,a)})}case"rweb/quickPromote/setFirstLoad":{const{firstLoad:a}=t.payload;return Object.assign({},e,{firstLoad:a})}case"rweb/quickPromote/account/setAdsAccount":{const{adsAccount:a}=t.payload;return Object.assign({},e,{account:Object.assign({},e.account,{adsAccount:a})})}case"rweb/quickPromote/account/setFundingInstruments":{const{fundingInstruments:a}=t.payload;return Object.assign({},e,{account:Object.assign({},e.account,{fundingInstruments:a})})}case"rweb/quickPromote/account/setSelectedFundingInstrument":{const{selectedFundingInstrument:a}=t.payload;return Object.assign({},e,{account:Object.assign({},e.account,{selectedFundingInstrument:a})})}case"rweb/quickPromote/account/setAccountDataFetchStatus":{const{fetchStatus:a}=t.payload;return Object.assign({},e,{account:Object.assign({},e.account,{accountDataFetchStatus:a})})}case"rweb/quickPromote/targeting/setInitialTargetedLocationsFetchStatus":{const{fetchStatus:a}=t.payload;return Object.assign({},e,{targeting:Object.assign({},e.targeting,{initialTargetedLocationsFetchStatus:a})})}case"rweb/quickPromote/targeting/setLocationQuery":{const{locationQuery:a}=t.payload;return Object.assign({},e,{targeting:Object.assign({},e.targeting,{locationQuery:a})})}case"rweb/quickPromote/targeting/setTargetedLocations":{const{targetedLocations:a}=t.payload;return Object.assign({},e,{targeting:Object.assign({},e.targeting,{targetedLocations:a})})}case"rweb/quickPromote/targeting/setTargetedAgeBucket":{const{ageBucket:a}=t.payload;return Object.assign({},e,{targeting:Object.assign({},e.targeting,{ageBucket:a})})}case"rweb/quickPromote/targeting/setTargetedGender":{const{gender:a}=t.payload;return Object.assign({},e,{targeting:Object.assign({},e.targeting,{gender:a})})}case"rweb/quickPromote/budget/setAvailableBudgetsFetchStatus":{const{fetchStatus:a}=t.payload;return Object.assign({},e,{budget:Object.assign({},e.budget,{availableBudgetsFetchStatus:a})})}case"rweb/quickPromote/budget/setAvailableBudgets":{const{availableBudgets:a,currency:r}=t.payload;return Object.assign({},e,{budget:Object.assign({},e.budget,{availableBudgets:a,currency:r})})}case"rweb/quickPromote/budget/setDailyBudget":{const{dailyBudget:a}=t.payload;return Object.assign({},e,{budget:Object.assign({},e.budget,{dailyBudget:a})})}case"rweb/quickPromote/budget/setBudgetDuration":{const{durationDays:a}=t.payload;return Object.assign({},e,{budget:Object.assign({},e.budget,{durationDays:a})})}case"rweb/quickPromote/budget/setBudgetErrorMessage":{const{errorMessage:a}=t.payload;return Object.assign({},e,{budget:Object.assign({},e.budget,{errorMessage:a})})}case"rweb/quickPromote/setPromoteFetchStatus":{const{promoteFetchStatus:a}=t.payload;return Object.assign({},e,{promoteStatus:a})}case"rweb/quickPromote/setPromoteErrorCode":{const{promoteErrorCode:a}=t.payload;return Object.assign({},e,{promoteErrorCode:a})}case J.REQUEST:return Object.assign({},e,{promoteStatus:_.a.LOADING});case J.FAILURE:return Object.assign({},e,{promoteStatus:_.a.FAILED});case J.SUCCESS:return Object.assign({},e,{promoteStatus:_.a.LOADED});default:return t.type,e}}});const ye=e=>e.quickPromote.budget.dailyBudget,Ee=e=>e.quickPromote.budget.durationDays,fe=e=>e.quickPromote.budget.errorMessage,Ae=e=>e.quickPromote.budget.availableBudgets||(e=>{throw new Error(e)})("No budgets found"),Oe=e=>e.quickPromote.budget.currency||"USD",Te=(e,t)=>{var a,r;const n=X(e);return null==(a=e.ads.typeahead.forecastAudience[n])||null==(r=a.result)?void 0:r.estimatedImpressions};var we=Object(u.a)().propsFromState(()=>({dailyBudget:ye,durationDays:Ee,availableBudgets:Ae,lang:m.f,currency:Oe,audience:Te,errorMessage:fe})).propsFromActions(()=>({createLocalApiErrorHandler:Object(g.d)("QUICK_PROMOTE_BUDGET_SELECT_SCREEN"),setDailyBudget:ue,setBudgetDuration:ge,fetchForecastedAudienceIfNeeded:N,setBudgetErrorMessage:me})).withAnalytics({page:"quick_promote"}),Ie=a("MWbm"),Pe=a("t62R"),ke=a("rHpw");const Se=({children:e,description:t,descriptionDir:a,descriptionTestID:r,label:n,withBottomBorder:c=!0})=>o.createElement(Ie.a,{style:[Le.descriptionItem,c?Le.bottomBorder:void 0]},!!n&&o.createElement(Pe.c,{weight:"bold"},n),!!t&&o.createElement(Ie.a,{style:Le.descriptionContainer},o.createElement(Pe.c,{color:"gray600",dir:a,size:"small",style:Le.descriptionContainer,testID:r},t)),e),Le=ke.a.create(e=>({descriptionItem:{backgroundColor:e.colors.cellBackground,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},descriptionContainer:{marginTop:e.spaces.space2},bottomBorder:{borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.colors.borderColor}}));var Ce=a("iOFy");const ve=({title:e,primaryLabel:t,subtitle:a})=>o.createElement(Ie.a,{style:[je.bottomBorder,je.titleContainer]},o.createElement(Pe.c,{align:"center",size:"large",weight:"heavy"},e),!!t&&o.createElement(Ie.a,{style:je.primaryLabelContainer},o.createElement(Pe.c,{align:"center",color:"primary",size:"xLarge"},t)),o.createElement(Ie.a,{style:je.subtitleContainer},o.createElement(Ce.a,{align:"center",color:"gray600"},a))),je=ke.a.create(e=>({titleContainer:{paddingVertical:e.spaces.space32},primaryLabelContainer:{marginTop:e.spaces.space12},subtitleContainer:{marginTop:e.spaces.space12},bottomBorder:{borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.colors.borderColor}}));var Be="introButton",De="nextButton",qe="targetingScreen",Fe="targetingLocationScreen",xe="budgetSelectScreen",Re="reviewScreen",Ne="reviewButton",Ge="reviewTargetingDescription",Me="reviewBudgetAndDurationDescription",Ue="reviewPaymentPivot",He="targetingLocationPivot",Ve="backButton",ze="targetingLocationSearch",Qe="targetingLocationItem",$e=a("Xrkv");const We=I.a.dc4a9413,Je=I.a.bad70c09,Ke=I.a.c133a39b,Xe=I.a.ee5da8f4,Ze=I.a.g4bf9cb7,Ye=I.a.gc3ce5d9,et=I.a.e542dfd6,tt=I.a.cb51c854,at=I.a.bb7b39e1,rt=I.a.eb9466d0,nt=I.a.c21037d0,ot=I.a.b07cc9f1,ct=I.a.ce309bed,st=I.a.c6c16a51,it=I.a.cc49d03f;function lt(e){switch(e){case"AnyGender":return tt;case"Male":return at;case"Female":return rt;default:return Object(P.a)("Unknown gender: "+e),e}}function dt(e){switch(e){case"COUNTRIES":return nt;case"REGIONS":return ot;case"METROS":return ct;case"CITIES":return st;case"POSTAL_CODES":return it;default:return Object(P.a)("Unknown targeting locationType: "+e),e}}function ut({totalBudgetNum:e,durationDays:t,lang:a,currency:r}){const n=e.toLocaleString(Object(F.e)(a),{currency:r,style:"currency",maximumFractionDigits:0,minimumFractionDigits:0});return We({totalBudget:n,durationLabel:mt({durationDays:t})})}function gt({numLocations:e}){const t=I.a.ia24dc8c(e);return Je({numLocations:t})}function mt({durationDays:e}){const t=I.a.ia24dc8c(e);return Ze({durationDays:t})}var ht=a("4zmP"),pt=a("9RkS");const bt=I.a.a3a09d48,_t=I.a.e7eb3683,yt=I.a.d9f6e3cd,Et=I.a.d9d6e10e,ft=I.a.b3954ec9,At=I.a.e1b48db4,Ot=Array(30).fill(null).map((e,t)=>t+1);class Tt extends o.PureComponent{constructor(...e){super(...e),n()(this,"_fetchForecastedAudienceIfNeeded",()=>{const{analytics:e,match:{params:{statusId:t}},fetchForecastedAudienceIfNeeded:a,createLocalApiErrorHandler:r}=this.props;a(t,e).catch(r())}),n()(this,"_getSliderProps",(e,t)=>({max:e.length-1,min:0,value:e.indexOf(t)})),n()(this,"_handleDurationSlider",e=>{const{setBudgetDuration:t,durationDays:a,analytics:r}=this.props,n=Ot[e];a!==n&&(Object(F.o)(r)(F.m.setBudgetDuration(""+n)),t(n),this._fetchForecastedAudienceIfNeeded())}),n()(this,"_handleBudgetSlider",e=>{const{setDailyBudget:t,availableBudgets:a,dailyBudget:r,analytics:n}=this.props,o=a[e];r!==o&&(Object(F.o)(n)(F.m.setDailyBudget(""+o)),t(o),this._fetchForecastedAudienceIfNeeded())})}componentDidMount(){const{analytics:e}=this.props;Object(F.o)(e)(F.m.budgetSelectPageLoad()),this._fetchForecastedAudienceIfNeeded()}componentWillUnmount(){const{setBudgetErrorMessage:e}=this.props;e(null)}render(){const{durationDays:e,lang:t,dailyBudget:a,availableBudgets:r,currency:n,audience:c,errorMessage:s}=this.props,i=a.toLocaleString(Object(F.e)(t),{currency:n,style:"currency",maximumFractionDigits:0,minimumFractionDigits:0}),l=c?function({low:e,high:t}){const a=I.a.cf8abf58(e),r=I.a.cf8abf58(t);return Ye({audienceLow:a,audienceHigh:r})}(c):" ",u=mt({durationDays:e}),g=this._getSliderProps(r,a),m=this._getSliderProps(Ot,e),h=ut({totalBudgetNum:a*e,durationDays:e,lang:t,currency:n});return o.createElement(Ie.a,{style:wt.qpContainer,testID:xe},s&&o.createElement(Ie.a,{style:wt.gutter},o.createElement(ht.a,{text:s,type:"danger"})),o.createElement(ve,{primaryLabel:h,subtitle:l,title:bt}),o.createElement(Se,{label:_t},o.createElement(Ie.a,null,o.createElement(pt.a,d()({accessibilityLabel:yt,accessibilityLabelValueText:`"${i}"`},g,{onChange:this._handleBudgetSlider,thumbLabel:i})))),o.createElement(Se,{label:Et},o.createElement(Ie.a,null,o.createElement(pt.a,d()({accessibilityLabel:ft,accessibilityLabelValueText:`"${u}"`},m,{onChange:this._handleDurationSlider,thumbLabel:u})))),c?o.createElement(Ie.a,{style:wt.disclaimer},o.createElement(Ce.a,{align:"center",color:"gray600",size:"small"},At)):null)}}n()(Tt,"contextType",i.a);const wt=ke.a.create(e=>({qpContainer:{flex:1},disclaimer:{marginVertical:e.componentDimensions.gutterVertical,marginHorizontal:e.componentDimensions.gutterHorizontal},gutter:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical}}));var It=we(Tt),Pt=a("XOJV");const kt=(e,t)=>t.match.params.statusId,St=(e,t)=>Pt.a.selectHydrated(e,kt(0,t)),Lt=(e,t)=>Object(_.c)(Pt.a.selectFetchStatus(e,kt(0,t)),e.quickPromote.budget.availableBudgetsFetchStatus,e.quickPromote.targeting.initialTargetedLocationsFetchStatus,e.quickPromote.account.accountDataFetchStatus,e.quickPromote.firstLoad?_.a.LOADED:_.a.LOADING),Ct=(e,t)=>e.quickPromote.promoteStatus,vt=(e,t)=>e.quickPromote.promoteErrorCode,jt=e=>{const{match:t,history:a}=e,{screenName:r,statusId:n,quickPromotePlatform:o,quickPromoteScreenName:c}=t.params;return((e,t,a,r,n)=>(o,c,{userPersistence:s})=>s.get("rweb.quickPromoteRedirectBack").catch(()=>{}).then(s=>{if(s&&s.platformType&&s.lastPersisted&&(new Date).getTime()-s.lastPersisted<36e5){const{ageBucket:a,gender:r,targetedLocations:i,dailyBudget:l,durationDays:d,platformType:u,currency:g}=s,{currency:m}=c().quickPromote.budget;o(Z({ageBucket:a,gender:r,targetedLocations:i})),g===m?(o(Y({dailyBudget:l,durationDays:d})),n.replace(Object(F.h)(e,t,u,F.c.Review))):(o(Y({errorMessage:x})),n.replace(Object(F.h)(e,t,u,F.c.BudgetSelect)))}else r===F.c.Intro||c().quickPromote.firstLoad||n.replace(Object(F.h)(e,t,a,F.c.Intro));o(he(!0))}))(r,n,o,c,a)};var Bt=Object(u.a)().propsFromState(()=>({statusId:kt,fetchStatus:Lt,tweet:St,promoteFetchStatus:Ct,promoteErrorCode:vt})).propsFromActions(e=>({createLocalApiErrorHandler:Object(g.d)("QUICK_PROMOTE_SCREEN"),fetchTweetIfNeeded:Pt.a.fetchOneIfNeeded,fetchCurrentTargetingLocationIfNeeded:Q,fetchAvailableBudgetsIfNeeded:$,fetchAdsAccountDataIfNeeded:U,handleFirstLoad:()=>jt(e),setPromoteFetchStatus:pe})).withAnalytics(F.n),Dt=Object(u.a)().propsFromState(()=>({})).propsFromActions(()=>({})).withAnalytics(F.n),qt=a("feu+");const Ft=I.a.e1bca506,xt=I.a.e4a4c608,Rt=I.a.a219e217;class Nt extends o.PureComponent{constructor(...e){super(...e),n()(this,"_handleGoToAnalytics",()=>{const{match:e,history:t}=this.props,{screenName:a,statusId:r,quickPromotePlatform:n}=e.params;Object(F.j)(t)(a,r,n)}),n()(this,"_handleClose",()=>{const{history:e,location:t}=this.props;e.goBackToNonModalRoute({location:t})})}componentDidMount(){const{analytics:e}=this.props;Object(F.o)(e)(F.m.donePageLoad())}render(){return o.createElement(qt.a,{actionLabel:Rt,headline:Ft,isFullHeightOnMobile:!0,onAction:this._handleGoToAnalytics,onClose:this._handleClose,subtext:xt,withCloseButton:!1})}}n()(Nt,"contextType",i.a);var Gt=Dt(Nt),Mt=a("v//M"),Ut=a("W5XZ"),Ht=a("jHSc");const Vt=e=>!!e.quickPromote.account.selectedFundingInstrument;var zt=Object(u.a)().propsFromState(()=>({hasFundingInstrument:Vt})).propsFromActions(()=>({})).withAnalytics(F.n);const Qt=I.a.dcfb0332,$t=I.a.db841200,Wt=I.a.hc67be9d;class Jt extends o.PureComponent{constructor(...e){super(...e),n()(this,"_handleGoToNextPage",()=>{const{history:e,match:t}=this.props,{screenName:a,statusId:r,quickPromotePlatform:n}=t.params;e.push(Object(F.h)(a,r,n,F.c.Targeting))}),n()(this,"_handleClose",()=>{const{history:e,location:t}=this.props;e.goBackToNonModalRoute({location:t})})}componentDidMount(){const{analytics:e,hasFundingInstrument:t}=this.props;Object(F.o)(e)(F.m.introPageLoad({hasFundingInstrument:t}))}render(){const{match:e}=this.props,{quickPromotePlatform:t}=e.params,a=t===F.a.Rweb;return o.createElement(qt.a,{actionLabel:Wt,headline:Qt,isFullHeightOnMobile:!0,onAction:this._handleGoToNextPage,onClose:this._handleClose,primaryButtonTestID:Be,subtext:$t,withCloseButton:a})}}n()(Jt,"contextType",i.a);var Kt=zt(Jt),Xt=a("tI3i"),Zt=a.n(Xt),Yt=(a("VAZu"),a("zh9S"));const ea=(e,t)=>t.match.params.statusId,ta=(e,t)=>Pt.a.selectHydrated(e,ea(0,t)),aa=(e,t)=>Pt.a.selectFetchStatus(e,ea(0,t)),ra=(e,t)=>e.quickPromote.account.adsAccount;var na=Object(u.a)().propsFromState(()=>({fetchStatus:aa,tweet:ta,adsAccount:ra})).propsFromActions(e=>({createLocalApiErrorHandler:Object(g.d)("QUICK_PROMOTE_PAYMENT_SCREEN"),fetchTweetIfNeeded:Pt.a.fetchOneIfNeeded,scribeAction:Yt.c,savePlatformRedirectBackState:()=>M(e.match.params.quickPromotePlatform),fetchAdsAccountDataIfNeeded:U})).withAnalytics(F.n),oa=a("Rp9C"),ca=a("E0cF"),sa=a("bPFD");class ia extends o.PureComponent{constructor(...e){super(...e),n()(this,"_setAppBarRef",e=>{this._appBarRef=e}),n()(this,"_handleIFrameMessage",e=>{const{analytics:t,tweet:a}=this.props;if(e&&"quick_promote"===e.name)if("scribe"===e.type){const r=a&&ca.a.getOriginalTweet(a)||void 0,n=r?[oa.a.getTweetItem(r)]:[],o=e.scribeData||{},c="string"==typeof o.component?o.component:"quick_promote",s="string"==typeof o.uiEvent?o.uiEvent:"";t.scribe({component:c,action:s,data:{items:n}})}else if("navigation"===e.type){const{history:e,match:t,fetchAdsAccountDataIfNeeded:a,createLocalApiErrorHandler:r}=this.props,{screenName:n,statusId:o,quickPromotePlatform:c}=t.params;Zt()(!!this.context.loggedInUserId,"loggedInUserId must be defined"),a(this.context.loggedInUserId,!0).catch(r()),e.push(`/${n}/status/${o}/${c}/${F.c.Review}`)}else"close"===e.type&&this._appBarRef&&this._appBarRef.goBack()})}componentDidMount(){const{savePlatformRedirectBackState:e,analytics:t,adsAccount:a,match:r}=this.props,{quickPromotePlatform:n,statusId:o}=r.params;e();const c=Object(F.g)(n,a,o);Object(F.o)(t)(F.m.paymentPageLoad(c.url)),c.isSameHost||(window.location.href=c.url)}render(){const{adsAccount:e,match:t}=this.props,{quickPromotePlatform:a,statusId:r}=t.params,n=Object(F.g)(a,e,r);return n.isSameHost?o.createElement(sa.a,{dangerouslyDisableSandbox:!0,onMessage:this._handleIFrameMessage,reportError:P.a,src:n.url,style:la.iframe}):null}}n()(ia,"contextType",i.a);const la=ke.a.create(e=>({iframe:{flexGrow:1}}));var da=na(ia);const ua=(e,t)=>e.quickPromote.targeting.targetedLocations,ga=(e,t)=>e.quickPromote.targeting.ageBucket,ma=(e,t)=>e.quickPromote.targeting.gender,ha=(e,t)=>e.quickPromote.budget.dailyBudget,pa=(e,t)=>e.quickPromote.budget.durationDays,ba=e=>e.quickPromote.budget.currency||"USD",_a=e=>e.quickPromote.account.selectedFundingInstrument,ya=e=>e.quickPromote.account.adsAccount,Ea=e=>e.quickPromote.promoteStatus,fa=e=>e.quickPromote.promoteErrorCode,Aa=({history:e,match:t})=>a=>{const{screenName:r,statusId:n,quickPromotePlatform:o}=t.params;return((e,t,a,r,n)=>(o,c,{api:s})=>{var i;const l=G(c()),{session:{user_id:d},quickPromote:{targeting:{ageBucket:u,gender:g,targetedLocations:[{targeting_value:m}]},budget:{dailyBudget:h,durationDays:p},account:{selectedFundingInstrument:b}}}=c(),_=null==(i=c().quickPromote.account.adsAccount)?void 0:i.id;if(R.includes(c().quickPromote.promoteStatus))return Promise.resolve();if(!_||!d)return Object(F.o)(n)(F.m.promotionError("Unauthorized")),o(be("Unauthorized")),Promise.resolve();if(!b)return Object(F.o)(n)(F.m.promotionError("MissingFundingInstrument")),o(be("MissingFundingInstrument")),Promise.resolve();o(be(null));const y=b.id,E=Math.round(1e6*h),f=E*p;return Object(F.o)(n)(F.m.promotionCall({dailyBudgetMicros:E,totalBudgetMicros:f,ageBucket:u,gender:g,location:m})),o(_e({userId:d,accountId:""+parseInt(_,36),fundingInstrumentId:""+parseInt(y,36),tweetId:a,budget:{daily_local_micros:""+E,total_local_micros:""+f},targeting:l})).catch(()=>(o(be("NetworkError")),Object(F.o)(n)(F.m.promotionError("NetworkError")),{type:"fail"})).then(c=>{var s,i,l;if("fail"!==c.type){var u;if("QuickPromoteError"===(null==(s=c.quick_promote_campaign)?void 0:s.__typename))return o(be(c.quick_promote_campaign.error_code)),Object(F.o)(n)(F.m.promotionError((null==(u=c.quick_promote_campaign)?void 0:u.error_code)||"QuickPromoteError")),o(U(d,!0));if("PromotionIneligible"===(null==(i=c.quick_promote_campaign)?void 0:i.response_code))Object(F.o)(n)(F.m.promotionError("PromotionIneligible")),o(be("PromotionIneligible"));else if(null==(l=c.quick_promote_campaign)?void 0:l.response_code)return void e.push(Object(F.h)(t,a,r,F.c.Done))}})})(e,r,n,o,a)};var Oa=Object(u.a)().propsFromState(()=>({targetedLocations:ua,ageBucket:ga,gender:ma,dailyBudget:ha,durationDays:pa,lang:m.f,country:K,currency:ba,fundingInstrument:_a,adsAccount:ya,promoteStatus:Ea,promoteErrorCode:fa})).propsFromActions(e=>({createLocalApiErrorHandler:Object(g.d)("QUICK_PROMOTE_REVIEW_SCREEN"),clearPersistedRedirectBackState:()=>M(),createPromotion:Aa(e)})).withAnalytics(F.n),Ta=a("csss"),wa=a("/yvb"),Ia=a("shC7");const Pa=I.a.c3c57e3e,ka=I.a.h06724b4,Sa=I.a.b069d89c,La=I.a.a3a09d48,Ca=I.a.e36bce63,va=I.a.i41612d9,ja=I.a.ed8bb5af,Ba=I.a.be2dc078,Da=I.a.da2805d1,qa=I.a.ef4602eb,Fa=I.a.a4db098b,xa=I.a.ef7e3916;class Ra extends o.PureComponent{constructor(...e){super(...e),n()(this,"_getPaymentDescription",()=>{const{adsAccount:e}=this.props;return e&&e.timezone&&e.country_code?ja:Ba}),n()(this,"_handlePromote",()=>{const{createPromotion:e,analytics:t}=this.props;Object(F.o)(t)(F.m.promotionClick()),e(t)}),n()(this,"_getErrorMessage",()=>{const{promoteErrorCode:e,promoteStatus:t}=this.props;if(!e)return t===_.a.LOADED?Da:null;switch(e){case"MissingFundingInstrument":case"InvalidPaymentMethod":return xa;case"CampaignCreationFailed":case"PromotionIneligible":return Fa;default:return qa}})}componentDidMount(){const{analytics:e,clearPersistedRedirectBackState:t,fundingInstrument:a}=this.props;t();const r=!!a;Object(F.o)(e)(F.m.reviewPageLoad({hasFundingInstrument:r}))}render(){const{targetedLocations:e,ageBucket:t,gender:a,dailyBudget:r,durationDays:n,lang:c,country:s,currency:i,fundingInstrument:l,match:d,promoteStatus:u}=this.props,g=function({minAge:e,maxAge:t}){return t?Ke({minAge:e,maxAge:t}):Xe({minAge:e})}(O[t]),m=function({locations:e,formattedAge:t,gender:a}){const r=e.length;return et({locations:Object($e.a)(e),locationsHeading:gt({numLocations:r}),formattedAge:t,gender:a})}({locations:e.map(({localized_name:e})=>e),formattedAge:g,gender:lt(a)}),h=ut({totalBudgetNum:r*n,durationDays:n,lang:c,currency:i}),{screenName:p,statusId:b,quickPromotePlatform:_}=d.params,y=this._getErrorMessage();return o.createElement(o.Fragment,null,o.createElement(Ie.a,{style:Na.qpContainer,testID:Re},y&&o.createElement(Ie.a,{style:Na.gutter},o.createElement(ht.a,{text:y,type:"danger"})),o.createElement(ve,{subtitle:ka,title:Pa}),o.createElement(Se,{description:m,descriptionTestID:Ge,label:Sa}),o.createElement(Se,{description:h,descriptionDir:Ia.a.isRTL?"rtl":"ltr",descriptionTestID:Me,label:La}),o.createElement(Ta.a,{description:l?l.description:o.createElement(Pe.c,{color:"primary",size:"small"},this._getPaymentDescription()),label:o.createElement(Pe.c,{weight:"bold"},Ca),link:l?void 0:Object(F.h)(p,b,_,F.c.Payment),testID:Ue})),o.createElement(Ie.a,{style:Na.bottomElements},o.createElement(wa.a,{disabled:!l||R.includes(u),onPress:this._handlePromote,size:"normalLarge",testID:Ne,type:"primary"},va),o.createElement(Ce.a,{style:Na.terms},(E=s,o.createElement(I.a.I18NFormatMessage,{$i18n:"c99d7100"},o.createElement(Pe.c,{link:Object(F.i)(E)},I.a.d56b5ac3))))));var E}}n()(Ra,"contextType",i.a);const Na=ke.a.create(e=>({qpContainer:{flex:1},bottomElements:{marginHorizontal:e.spaces.space12,marginVertical:e.spaces.space32},terms:{marginTop:e.spaces.space12,textAlign:"center",color:e.colors.gray600,fontSize:e.fontSizes.xSmall},gutter:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical}}));var Ga=Oa(Ra),Ma=a("zCf4"),Ua=a("zrOZ");const Ha=(e,t)=>{const a=za(e,t);return e.ads.typeahead.targetingLocation[a]},Va=(e,t)=>{var a;const r=za(e,t);return null==(a=e.ads.typeahead.targetingLocation[r])?void 0:a.fetchStatus},za=(e,t)=>e.quickPromote.targeting.locationQuery,Qa=(e,t)=>e.quickPromote.targeting.targetedLocations;var $a=Object(u.a)().propsFromState(()=>({targetingLocationQuery:za,targetingLocations:Ha,targetedLocations:Qa,fetchStatus:Va,userCountry:m.l})).propsFromActions(()=>({setTargetedLocations:oe,setAndFetchTargetingLocationQuery:z,setTargetingLocationQuery:ce,createLocalApiErrorHandler:Object(g.d)("QUICK_PROMOTE_TARGETING_LOCATION_SCREEN")})).withAnalytics(F.n),Wa=a("VwDm"),Ja=a("G1WX"),Ka=a("cCdp"),Xa=a("xKuM"),Za=a("6OUF");const Ya=I.a.cc642518,er=I.a.i0e8c3c6,tr=I.a.deaf5b15,ar=I.a.f69ad048,rr=Object.freeze({COUNTRIES:0,REGIONS:1,METROS:2,CITIES:3,POSTAL_CODES:4}),nr=Object.freeze({[F.d.CurrentCountryMatch]:0,[F.d.Match]:1,[F.d.NoMatch]:2});class or extends o.PureComponent{constructor(...e){super(...e),n()(this,"state",{errorMessage:null}),n()(this,"_renderSearch",()=>{const{fetchStatus:e,targetingLocationQuery:t}=this.props;return o.createElement(cr,{onBack:this._handleGoBack,onChange:this._handleTargetingLocationChange,onClear:this._handleClear,targetingLocationQuery:t},o.createElement(Ie.a,null,o.createElement(Pe.c,{style:sr.headingText,weight:"heavy"},er)),o.createElement(Ja.a,{fetchStatus:e,render:this._renderSearchList,retryMessage:tr}))}),n()(this,"_handleClear",()=>{const{setTargetingLocationQuery:e}=this.props;e("")}),n()(this,"_renderSearchList",()=>{const{targetedLocations:e}=this.props,t=Object(Ua.a)(e.map(({targeting_value:e})=>e)),a=this._getTargetingLocationOptions();return o.createElement(Ie.a,{style:sr.overflow},a.map(({location_type:e,targeting_value:a,localized_name:r})=>o.createElement(Ka.a,{checked:t.has(a),helpText:dt(e),key:a,label:r,name:a,onChange:this._handleSearchSelect,testID:Qe})))}),n()(this,"_getTargetingLocationOptions",()=>{var e,t,a;const{targetingLocations:r,userCountry:n,targetingLocationQuery:o}=this.props,c=null!=(e=null==r||null==(t=r.result)||null==(a=t[0])?void 0:a.locations)?e:[],s=Object(F.f)(n||"US");return c.filter(({country_code:e,localized_name:t})=>s(t,e,o)!==F.d.NoMatch).sort(Object(F.l)(({country_code:e,localized_name:t})=>{const a=s(t,e,o);return nr[a]},({location_type:e,localized_name:t})=>{var a;return null!=(a=rr[e])?a:(e=>{Object(P.a)(`Quick Promote: Unknown location type: ${e}. Expected one of {${Object.keys(rr).join(", ")}}`)})(e)||Object.keys(rr).length},({localized_name:e})=>e))}),n()(this,"_handleSearchSelect",(e,t)=>{const{setTargetedLocations:a,analytics:r,setTargetingLocationQuery:n}=this.props;if(t){this.setState({errorMessage:null});const t=this._getTargetingLocationOptions().find(({targeting_value:t})=>t===e);t?(Object(F.o)(r)(F.m.setTargetingLocation({id:t.targeting_value,locationType:t.location_type,countryCode:t.country_code})),a([t]),this._handleGoBack()):Object(P.a)(`Quick Promote: could not find "${e}" in list of targeting options`)}else Object(F.o)(r)(F.m.targetingLocationError()),this.setState({errorMessage:ar});n("")}),n()(this,"_renderSelected",()=>{const{targetedLocations:e,targetingLocationQuery:t}=this.props,{errorMessage:a}=this.state;return o.createElement(cr,{onBack:this._handleGoBack,onChange:this._handleTargetingLocationChange,onClear:this._handleClear,targetingLocationQuery:t},o.createElement(Ie.a,null,a&&o.createElement(Ie.a,{style:sr.gutter},o.createElement(ht.a,{text:a,type:"danger"})),o.createElement(Pe.c,{style:sr.headingText,weight:"heavy"},gt({numLocations:e.length}))),o.createElement(Ie.a,null,e.map(({localized_name:e,targeting_value:t,location_type:a})=>o.createElement(Ka.a,{checked:!0,helpText:dt(a),key:t,label:e,name:t,onChange:this._handleSearchSelect,testID:Qe}))))}),n()(this,"_handleGoBack",()=>{const{history:e,location:t,match:a}=this.props,{quickPromotePlatform:r,quickPromoteScreenName:n,screenName:o,statusId:c}=a.params;Object(F.k)(e,t)(o,c,r,n)}),n()(this,"_handleTargetingLocationChange",e=>{const t=e.target.value,{createLocalApiErrorHandler:a,setAndFetchTargetingLocationQuery:r,analytics:n}=this.props;Object(F.o)(n)(F.m.targetingLocationSearch(t)),r(t).catch(a())})}componentDidMount(){const{analytics:e}=this.props;Object(F.o)(e)(F.m.targetingLocationPageLoad())}componentWillUnmount(){this._handleClear()}render(){const{targetingLocationQuery:e}=this.props;return e?this._renderSearch():this._renderSelected()}}n()(or,"contextType",i.a);const cr=({onBack:e,onChange:t,onClear:a,targetingLocationQuery:r,children:n})=>o.createElement(Ie.a,{style:sr.qpContainer,testID:Fe},o.createElement(Xa.a,{leftControl:o.createElement(s.a,{onClick:e}),middleControl:o.createElement(Za.a,{Icon:Wa.a,autoFocus:!0,name:"locationTargetingInput",onChange:t,onClear:a,placeholder:Ya,style:sr.input,testID:ze,value:r,withClearButton:!0})}),n),sr=ke.a.create(e=>({qpContainer:{flex:1},input:{marginVertical:e.spaces.space12},headingText:{fontSize:e.fontSizes.large,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.colors.borderColor,borderTopWidth:1,borderTopStyle:"solid",borderTopColor:e.colors.borderColor},gutter:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},overflow:{flex:"1 1 200px",overflowY:"auto"}}));var ir=$a(or);const lr=(e,t)=>e.quickPromote.targeting.targetedLocations,dr=(e,t)=>e.quickPromote.targeting.gender,ur=(e,t)=>e.quickPromote.targeting.ageBucket;var gr=Object(u.a)().propsFromState(()=>({targetedLocations:lr,selectedGender:dr,selectedAgeBucket:ur})).propsFromActions(()=>({setTargetedAgeBucket:se,setTargetedGender:ie})).withAnalytics(F.n),mr=a("JiIh"),hr=a("V2ml"),pr=a("J4ZH"),br=a("mN6z");const _r=I.a.hba1d105,yr=I.a.cba0133d,Er=I.a.e1efbead,fr=I.a.c6ff7c1f,Ar=I.a.b555fb45,Or=I.a.a8d0108d,Tr=[f.Any,f.Female,f.Male].map(e=>({label:lt(e),value:e})),wr=I.a.j2c03e12,Ir=["13","18","21","25","35","50"],Pr=[void 0,void 0,void 0,"24","34","49","54"],kr=Object(pr.a)((Sr=O,Object.values(Sr)),e=>e.maxAge||"over");var Sr;const Lr=Pr.length;function Cr(e,t){var a;if(e&&t)return null==(a=T[e])?void 0:a[t]}class vr extends o.PureComponent{constructor(...e){super(...e),n()(this,"_handleGenderChange",(e,t)=>{const{setTargetedGender:a,analytics:r}=this.props;a(t),Object(F.o)(r)(F.m.setTargetingGender(t))}),n()(this,"_handleAgeBucketChange",([e,t],a)=>{const{selectedAgeBucket:r,setTargetedAgeBucket:n,analytics:o}=this.props,c=this._sliderValueFromSelectedAgeBucket(r);if(!Object(br.a)(c,[e,t]))if(a){const a=Ir[e];if(!a)return;const r=Cr(a,t===Lr?"over":Pr[t]);if(r)Object(F.o)(o)(F.m.setTargetingAgeBucket(r)),n(r);else{const e=Object.keys(T[a])[0];this._setAgeBucket({minAge:a,maxAge:e})}}else{const a=t===Lr?"over":Pr[t];if(!a)return;const r=Cr(Ir[e],a);if(r)Object(F.o)(o)(F.m.setTargetingAgeBucket(r)),n(r);else{const{minAge:e}=kr[a].slice(-1)[0];this._setAgeBucket({minAge:e,maxAge:a})}}}),n()(this,"_setAgeBucket",({minAge:e,maxAge:t})=>{const{setTargetedAgeBucket:a,analytics:r}=this.props,n=T[e][t||"over"];if(!n)throw new Error(`Age bucket not found for minAge: "${e}", maxAge: "${t||"<empty>"}"`);Object(F.o)(r)(F.m.setTargetingAgeBucket(n)),a(n)})}componentDidMount(){const{analytics:e}=this.props;Object(F.o)(e)(F.m.targetingPageLoad())}_sliderValueFromSelectedAgeBucket(e){const{minAge:t,maxAge:a}=O[e];return[Ir.indexOf(t),a?Pr.indexOf(a):Lr]}render(){const{match:e,targetedLocations:t,selectedGender:a,selectedAgeBucket:r}=this.props,{screenName:n,statusId:c,quickPromotePlatform:s}=e.params,i=gt({numLocations:t.length}),{minAge:l,maxAge:d}=O[r],u=this._sliderValueFromSelectedAgeBucket(r),g=d||wr;return o.createElement(Ie.a,{style:jr.qpContainer,testID:qe},o.createElement(ve,{subtitle:yr,title:_r}),o.createElement(Ta.a,{description:Object($e.a)(t.map(({localized_name:e})=>e)),label:o.createElement(Pe.c,{weight:"bold"},i),link:Object(F.h)(n,c,s,F.c.TargetingLocation),testID:He}),o.createElement(Se,{label:Er},o.createElement(mr.a,{endThumbAccessibilityLabel:Ar,endThumbAccessibilityLabelValueText:`"${g}"`,endThumbLabel:g,max:Lr,min:0,onChange:this._handleAgeBucketChange,startThumbAccessibilityLabel:fr,startThumbAccessibilityLabelValueText:`"${l}"`,startThumbLabel:l,value:u})),o.createElement(Se,{label:Or,withBottomBorder:!1},o.createElement(Ie.a,{style:jr.radioGroup},o.createElement(hr.a,{name:"gender",onChange:this._handleGenderChange,options:Tr,value:a}))))}}n()(vr,"contextType",i.a);const jr=ke.a.create(e=>({qpContainer:{flex:1},radioGroup:{marginTop:e.spaces.space4}}));var Br=gr(vr),Dr=a("q9Zt"),qr=a("JYMr");const Fr=I.a.a065172e,xr=I.a.cfcdb4a1,Rr=I.a.dcfb0332,Nr=I.a.c1df579e;class Gr extends o.PureComponent{constructor(...e){super(...e),n()(this,"_getRetweetOrTweet",()=>{const{tweet:e}=this.props;return e?ca.a.getOriginalTweet(e):e}),n()(this,"_handleFetchTweet",()=>{const{createLocalApiErrorHandler:e,fetchTweetIfNeeded:t,statusId:a}=this.props;return t(a).catch(e(Ut.a))}),n()(this,"_handleFetchCurrentTargetingLocation",()=>{const{createLocalApiErrorHandler:e,fetchCurrentTargetingLocationIfNeeded:t}=this.props;return t().catch(e())}),n()(this,"_handleFetchBudgetOptions",()=>{const{createLocalApiErrorHandler:e,fetchAvailableBudgetsIfNeeded:t}=this.props;return t().catch(e())}),n()(this,"_handleFetchAdsAccountData",()=>{const{createLocalApiErrorHandler:e,fetchAdsAccountDataIfNeeded:t}=this.props;return Zt()(!!this.context.loggedInUserId,"loggedInUserId must be defined"),t(this.context.loggedInUserId).catch(e())}),n()(this,"_render",()=>{const{history:e}=this.props,t=this._getRetweetOrTweet();return!t||t&&t.user.id_str!==this.context.loggedInUserId?o.createElement(Ht.b,{history:e,onBackClick:this._handleGoBack,title:Rr},o.createElement(Dr.a,{onRetry:null,title:Fr})):this._renderPage()}),n()(this,"_renderHeader",()=>null),n()(this,"_renderPage",()=>{const{match:e,promoteFetchStatus:t,promoteErrorCode:a}=this.props,{quickPromoteScreenName:r,screenName:n,statusId:o,quickPromotePlatform:s}=e.params,i=e=>Object(F.h)(n,o,s,e);switch(r){case"intro":return this._renderSplashPage();case"targeting":{const e=i(F.c.BudgetSelect);return this._renderProgressPage(F.b.Targeting,e)}case"budget_select":{const e=i(F.c.Review);return this._renderProgressPage(F.b.BudgetSelect,e)}case"review":{const e=[_.a.LOADING,_.a.LOADED].includes(t)&&!a;return this._renderProgressPage(e?F.b.Finish:F.b.Review)}case"payment":return this._renderProgressPage(F.b.Review);case"targeting_location":return this._renderPopupPage();case"done":return this._renderSplashPage();default:throw c()}}),n()(this,"_renderProgressPage",(e,t)=>{const{history:a}=this.props;return o.createElement(Ht.b,{documentTitle:Rr,history:a,renderHeader:this._renderHeader},o.createElement(Xa.a,{leftControl:o.createElement(s.a,{onClick:this._handleGoBack,testID:Ve}),rightControl:t&&o.createElement(wa.a,{link:t,pullRight:!0,testID:De,type:"text"},Nr)}),o.createElement(qr.a,{progress:e,style:Mr.progressBar}),o.createElement(Ie.a,{style:Mr.noScrollView},this._renderRoutes()))}),n()(this,"_renderPopupPage",()=>{const{history:e}=this.props;return o.createElement(Ht.b,{documentTitle:Rr,history:e,renderHeader:this._renderHeader},this._renderRoutes())}),n()(this,"_renderSplashPage",()=>this._renderRoutes()),n()(this,"_renderRoutes",()=>{const{match:e}=this.props,{quickPromoteScreenName:t}=e.params;switch(t){case"intro":return o.createElement(Ma.b,{component:Kt});case"targeting":return o.createElement(Ma.b,{component:Br});case"targeting_location":return o.createElement(Ma.b,{component:ir});case"budget_select":return o.createElement(Ma.b,{component:It});case"review":return o.createElement(Ma.b,{component:Ga});case"payment":return o.createElement(Ma.b,{component:da});case"done":return o.createElement(Ma.b,{component:Gt});default:throw c()}}),n()(this,"_handleGoBack",()=>{const{history:e,match:t,location:a,analytics:r}=this.props,{screenName:n,statusId:o,quickPromotePlatform:c,quickPromoteScreenName:s}=t.params;Object(F.o)(r)(F.m.back(s)),Object(F.k)(e,a)(n,o,c,s)}),n()(this,"_handleRequestRetry",()=>{const{analytics:e,match:t}=this.props,{quickPromoteScreenName:a}=t.params;Object(F.o)(e)(F.m.reload(a)),window.location.reload()})}componentDidMount(){const{analytics:e,promoteFetchStatus:t,setPromoteFetchStatus:a,match:r}=this.props,{quickPromoteScreenName:n}=r.params;return _.a.LOADED===t&&n!==F.c.Done&&a(_.a.NONE),Promise.all([this._handleFetchTweet(),this._handleFetchCurrentTargetingLocation(),this._handleFetchAdsAccountData()]).then(()=>this._handleFetchBudgetOptions()).then(()=>{const{handleFirstLoad:e}=this.props;return e()}).catch(t=>{throw Object(F.o)(e)(F.m.pageLoadFail(t.message)),t})}render(){const{fetchStatus:e,history:t}=this.props;return e!==_.a.LOADED?o.createElement(Ht.b,{documentTitle:Rr,history:t,renderHeader:this._renderHeader},o.createElement(Mt.a,{fetchStatus:e,onRequestRetry:this._handleRequestRetry,render:this._render,retryMessage:xr})):o.createElement(Mt.a,{fetchStatus:e,onRequestRetry:this._handleRequestRetry,render:this._render,retryMessage:xr})}}n()(Gr,"contextType",i.a);const Mr=ke.a.create(e=>({progressBar:{backgroundColor:e.colors.gray50},noScrollView:{overflowX:"hidden",flex:1}})),Ur=Bt(Gr);t.default=Ur},z4TA:function(e,t,a){"use strict";a.r(t),a.d(t,"ConversationScreen",(function(){return Ie}));a("IAdD"),a("MvUL"),a("kYxP");var r=a("KEM+"),n=a.n(r),o=a("aeN7"),c=a("ERkP"),s=a("s4rk"),i=a("pxuL"),l=a("zI2C"),d=a("6ZtA"),u=a("es0u"),g=(a("x4t0"),a("WNMA"),a("zh9S")),m=a("6/RC"),h=a("oEGd"),p=a("0KEI"),b=a("hqKg"),_=a("8Lfv"),y=a("QK5w"),E=a("pNZL"),f=a("XOJV"),A=a("Mx3A");const O=(e,t)=>e.location&&e.location.state&&e.location.state[t],T=(e,t)=>{const a=O(t,"focal");return a||w(e,t)},w=(e,t)=>{const{location:a,match:r}=t;return r.params&&r.params.statusId?r.params.statusId:a.query&&a.query.tweet_id&&"string"==typeof a.query.tweet_id?a.query.tweet_id:""},I=Object(b.createSelector)(y.a,(e,t)=>O(t,"contextTweetId"),(e,t)=>f.a.selectFetchStatus(e,T(e,t)),(e,t)=>"PUSH"===t.history.action,(e,t)=>{if(!m.canUseDOM)return!1;const{location:a}=t,r=a.query,n=Object(y.a)(e,t);return Object(A.c)({query:r,httpReferer:n?"":document.referrer||"",requestUrl:window.location.href,emptyIfServerRendered:!1}).referral_type===A.a.Web},(e,t)=>{const a=O(t,"referrer"),r=T(e,t);return!!a&&a.includes("/i/topics/tweet/"+r)},(e,t)=>O(t,"promotedContent"),(e,t)=>t.location.query&&"string"==typeof t.location.query.cxt?t.location.query.cxt:void 0,(e,t)=>{const a=T(e,t),r=f.a.selectHydrated(e,a);return r&&r.conversation_id_str?f.a.selectHydrated(e,r.conversation_id_str):null},(e,t)=>f.a.selectHydrated(e,T(e,t)),(e,t)=>t.match.params.screenName,(e,t)=>O(t,"socialContext"),T,w,(e,t)=>O(t,"contextualClientEventInfo"),E.a,(e,t)=>O(t,"overflow"),(e,t,a,r,n,o,c,s,i,l,d,u,g,m,h,p,b)=>({contextTweetId:t,initialFetchStatus:a,isForwardNavigation:r,isInitialScreen:!e,isReferralSource:n,isReferredFromExploreTopics:o,promotedContent:c,richLandingContextId:s,rootTweet:i,focalTweet:l,screenName:d,selectedTweetId:m,socialContext:u,statusId:g,contextualClientEventInfo:h,tweetDetailNav:p,overflowCount:b})),P={createLocalApiErrorHandler:Object(p.d)("CONVERSATION_SCREEN"),googleAnalyticsPageView:g.a,scribePageImpression:g.d,clearTimelineCache:(e,t)=>Object(_.a)(e,t)};var k=Object(h.g)(I,P),S=a("ymux"),L=a("rkhm"),C=a("SrtL"),v=a("8UdT"),j=a("dwig"),B=a("kGix"),D=a("JyI6"),q=a("3XMw"),F=a.n(q),x=a("dFWS");const R=F.a.d2c7a41c,N=F.a.e20404df,G=F.a.d17df547;var M=({getLocationState:e,history:t})=>c.createElement(D.a,{accessibilityLabel:R,getLocationState:e,history:t,icon:c.createElement(x.a,null),label:G,scribeComponent:"floating_reply_button",shortLabel:N}),U=a("muX9"),H=(a("JtPf"),a("zb92"));var V=Object(H.a)({loader:()=>Promise.all([a.e(0),a.e(154)]).then(a.bind(null,"uo3S")),renderPlaceholder:(e,t)=>null}),z=a("rJoH"),Q=a("yoO3"),$=a("5FtR"),W=a("AUxQ"),J=a("QIgh"),K=a("I7xG"),X=a("BV3T"),Z=a("VTxf"),Y=a("SrIh"),ee=a("fTQJ"),te=a("ZNT5");var ae=e=>{const{richLandingContextId:t,statusId:a}=e;return((e,t)=>Object(te.a)({timelineId:"rich-tweet-landing-"+e,getEndpoint:e=>e.URT.fetchRichTweetLandingTimeline,getEndpointParams:e=>Object.assign({},e,t),context:"FETCH_RICH_TWEET_LANDING",perfKey:"rich-tweet-landing"}))(t?`${a}-${t}`:a,{refsrc_tweet:a,rux_cxt:t})},re=a("wgnn");const ne=e=>{switch(e){case re.a.NOT_FOUND:return c.createElement(Z.a,null);case re.a.NOT_ALLOWED:return c.createElement(X.a,null);default:return Object(Y.a)("Unhandled timeline unavailable reason: "+e),null}},oe=()=>c.createElement(Z.a,null);class ce extends c.Component{constructor(...e){super(...e),n()(this,"_getModule",Object(K.a)(this,e=>e.statusId,e=>e.richLandingContextId,(e,t)=>ae({statusId:e,richLandingContextId:t})))}render(){const{title:e}=this.props;return c.createElement(ee.a,{entryConfiguration:J.b,module:this._getModule(),renderEmptyState:oe,renderUnavailable:ne,title:e})}}var se=a("Rp9C"),ie=a("7JQg");const le=Object.freeze({Email:"email"});var de=a("VS6U");var ue=a("G8HL"),ge=a("oQhu"),me=a("mN6z");const he=F.a.d58baa7e,pe=F.a.bea869b3,be=F.a.c299a6cf,_e=F.a.ad666301,ye=F.a.f0c37ddb,Ee={page:"tweet"},fe={page:"tweet",section:"landing"},Ae=Object(ge.a)((e,t)=>({items:[se.a.forTweet(e,t)],tweet_id:e})),Oe=Object(ge.a)(e=>Object(L.a)(e)),Te=Object(ge.a)((e,t,a)=>{var r,n;return{referrer:e,controller_data:e&&(null==t||null==(r=t.details)||null==(n=r.timelinesDetails)?void 0:n.controllerData),overflowCount:a}}),we=Object(ge.a)((e,t)=>Object(S.a)({focalTweetId:e,fetchOptions:t}));class Ie extends c.Component{constructor(e,t){super(e,t),n()(this,"_getFabState",()=>{const{promotedContent:e,statusId:t}=this.props;return{inReplyToStatusId:t,promotedContent:e}}),n()(this,"_shouldRedirectToOcfLiteLogin",()=>{const{location:e}=this.props,{loggedInUserId:t}=this.context;return(({isUserLoggedIn:e,location:t})=>(e=>{const{query:t}=e;return"refsrc"in t&&"string"==typeof t.refsrc?t.refsrc:""})(t)===le.Email&&!e)({isUserLoggedIn:!!t,location:e})&&this._isOcfLiteLoginEnabled}),n()(this,"_isBucketedInRichTweetLandingExperiment",()=>{const{isReferralSource:e,isReferredFromExploreTopics:t,richLandingContextId:a}=this.props;return!(a||!e||t)&&this.context.featureSwitches.isTrue("responsive_web_rich_tweet_landing_enabled")}),n()(this,"_getNavigationParams",()=>{const{tweetDetailNav:e,contextualClientEventInfo:t,overflowCount:a}=this.props;return Te(e,t,a)}),n()(this,"_getModule",()=>{const{statusId:e}=this.props,t=this._getNavigationParams();return we(e,t)}),n()(this,"_handleEntriesUpdate",({entries:e,fetchStatus:t})=>{const{recordTTFL:a}=this.props;if(t===B.a.FAILED&&(this._shouldRecordTTFL=!1),this._shouldRecordTTFL&&e.length){const t=e.some(({type:e})=>e===v.b.Tweet);this._shouldRecordTTFL=!1,t&&a&&a("permalink")}}),n()(this,"_shouldRedirectToCanonical",()=>{const{focalTweet:e,screenName:t,selectedTweetId:a,statusId:r}=this.props;return a===r&&(t&&e&&t.toLowerCase()!==e.user.screen_name.toLowerCase())}),n()(this,"_redirectToCanonical",()=>{const{history:e,location:t}=this.props;e.replace({pathname:this._getCanonicalPath(),query:t.query,state:t.state})}),n()(this,"_getCanonicalPath",()=>{const{focalTweet:e}=this.props;return e?`/${e.user.screen_name}/status/${e.id_str}`:"/"}),n()(this,"_getPathForTweetId",(e,t)=>`/${t||"i"}/status/${e}`),n()(this,"_getScribeNamespace",()=>this._shouldRenderRichTweetLandingTimeline()?fe:Ee),this._shouldRecordTTFL=e.isInitialScreen,this._isInlineReplyEnabled=this.context.featureSwitches.isTrue("responsive_web_inline_reply_enabled"),this._isInlineReplyWithFabEnabled=this.context.featureSwitches.isTrue("responsive_web_inline_reply_with_fab_enabled"),this._replyCountsEnabled=this.context.featureSwitches.isTrue("responsive_web_reply_counts_enabled"),this._isOcfLiteLoginEnabled=this.context.featureSwitches.isTrue("responsive_web_ocf_lite_login_flow_enabled")}shouldComponentUpdate(e){return!Object(me.a)(e,this.props)}componentDidMount(){const{history:e,location:t,isForwardNavigation:a}=this.props;if(this._shouldRenderRichTweetLandingTimeline()&&(!t.state||!t.state.isRichTweetLanding)){const a=Object.assign({},t,{state:Object.assign({},t.state,{isRichTweetLanding:!0})});e.replace(a)}a&&this._clearTimelineCache()}componentWillUnmount(){this.context.setBackgroundClickHandler(null)}componentDidUpdate(e){this._shouldRedirectToCanonical()?this._redirectToCanonical():this.props.statusId!==e.statusId&&this.props.isForwardNavigation&&this._clearTimelineCache()}render(){const{loggedInUserId:e}=this.context,{focalTweet:t,history:a,promotedContent:r,statusId:n}=this.props,o=t?ye({tweetText:t.text,fullName:t.user.name}):void 0,i=this._replyCountsEnabled&&t&&this._renderSubtitle(t),u=t&&"twitter://status?id="+t.id_str,g=t&&"https://twitter.com"+(this._getCanonicalPath()||""),m=t&&_e({fullName:t.user.name});return this._shouldRedirectToOcfLiteLogin()?c.createElement($.a,{to:"/i/flow/lite_login"}):c.createElement(ie.b,{data:Ae(n,r),namespace:this._getScribeNamespace()},c.createElement(Q.a,null,g?c.createElement(U.a,null,c.createElement("link",{href:g,rel:"canonical"}),c.createElement("link",{href:"https://publish.twitter.com/oembed?url="+g,rel:"alternate",title:o,type:"application/json+oembed"})):null,null,c.createElement(z.a,{canonical:g,description:null==t?void 0:t.full_text,image:null==t?void 0:t.user.profile_image_url_https,title:m,type:"article"}),c.createElement(d.a,{featureSwitches:this.context.featureSwitches,loggedInUserId:e,pageType:"tweetdetail"}),c.createElement(l.a,{deepLink:u}),g?c.createElement(s.a,{canonical:g}):null,c.createElement(de.a,{backLocation:"/",documentTitle:o,history:a,primaryContent:this._renderTimeline(),sidebarContent:this._renderSidebarContent(),subtitle:i,title:t&&t.self_thread?be:pe}),c.createElement(C.a,{title:o,withMeta:!1})))}_renderSubtitle(e){const t=e.reply_count,a=he(t);return 0===t?null:c.createElement(F.a.I18NFormatMessage,{$i18n:"j8884bec",formattedCount:a,count:t})}_renderSidebarContent(){const{focalTweet:e}=this.props;return e&&e.user.id_str?c.createElement(u.a,{withTopicsToFollow:!1,withWhoToFollow:!1},c.createElement(V,{focalTweetId:e.id_str})):null}_renderTimeline(){const{focalTweet:e,history:t,location:a,richLandingContextId:r,rootTweet:n,screenName:o,selectedTweetId:s,statusId:i,socialContext:l,promotedContent:d,contextTweetId:u}=this.props,g={selectedTweetId:s},m=this._isInlineReplyEnabled&&!this._isInlineReplyWithFabEnabled?null:c.createElement(M,{getLocationState:this._getFabState,history:t});return c.createElement(j.a,{fab:m},this._shouldRenderRichTweetLandingTimeline()?c.createElement(ce,{richLandingContextId:r,statusId:i,title:pe}):c.createElement(W.a,{apiErrorHandlerMap:Oe(o),contextTweetId:u,fetchOptions:this._getNavigationParams(),focalTweet:e,focalTweetId:i,location:a,module:this._getModule(),onEntriesUpdate:this._handleEntriesUpdate,promotedContent:d,rootTweet:n||void 0,selectedTweet:g,socialContext:l}))}_shouldRenderRichTweetLandingTimeline(){const{isReferredFromExploreTopics:e,richLandingContextId:t}=this.props;return!!t||e||this._isBucketedInRichTweetLandingExperiment()}_clearTimelineCache(e=this._getModule(),t=this._getNavigationParams()){const{clearTimelineCache:a,createLocalApiErrorHandler:r,screenName:n}=this.props;a(e,t).catch(r(Oe(n)))}}n()(Ie,"contextType",i.a),n()(Ie,"defaultProps",{recordTTFL:o.c});t.default=k(Object(ue.a)(Ie))}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/client-web/bundle.Conversation.056a0765.js.map